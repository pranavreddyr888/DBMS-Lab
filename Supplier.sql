create database Supply;
use Supply;
create table Supplier(sid int,sname varchar(20),city varchar(10),primary key(sid));
create table Parts(pid int primary key,pname varchar(20),color varchar(20));
create table Catalog(sid int,pid int,cost int, foreign key (sid) references Supplier(sid),foreign key (pid) references Parts(pid));
desc Supplier;
insert into Supplier values(10001,"Acme Widget","Bangalore");
insert into Supplier values(10002,"Johns","Kolkata");
insert into Supplier values(10003,"Vimal","Mumbai");
insert into Supplier values(10004,"Reliance","Delhi");
insert into Parts values(20001,"Book","Red");
insert into Parts values(20002,"Pen","Red");
insert into Parts values(20003,"Pencil","Green");
insert into Parts values(20004,"Mobile","Green");
insert into Parts values(20005,"Charger","Black");
insert into Catalog values(10001,20001,10);
insert into Catalog values(10001,20002,10);
insert into Catalog values(10001,20003,30);
insert into Catalog values(10001,20004,10);
insert into Catalog values(10001,20005,10);
insert into Catalog values(10002,20001,10);
insert into Catalog values(10002,20002,20);
insert into Catalog values(10003,20003,30);
insert into Catalog values(10004,20003,40);

select distinct p.pname from Parts p where  p.pid in(select pid from Catalog c,Supplier s where s.sid=c.sid);
select sname from Supplier where not exists(select pid from parts where pid not in(select pid from Catalog where Supplier.sid=Catalog.sid));
desc Supplier;
select sname from Supplier where exists(select pid from Catalog where pid in(select pid from Parts where Parts.color="red") and Catalog.sid=Supplier.sid);
select pname from parts where pid in(select pid from Catalog where sid=10001) and pid not in(select pid from Catalog where sid!=10001);
select distinct c1.sid from Catalog c1 where c1.cost>(select avg(c2.cost) from Catalog c2 where c2.pid=c1.pid);
select p.pid,s.sname from parts p join catalog c on p.pid=c.pid join supplier s on c.sid=s.sid where c.cost=(select max(cost) from Catalog where p.pid=pid);
